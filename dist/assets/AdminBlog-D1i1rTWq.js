var k=Object.defineProperty,z=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var w=(n,s,i)=>s in n?k(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i,u=(n,s)=>{for(var i in s||(s={}))B.call(s,i)&&w(n,i,s[i]);if(N)for(var i of N(s))C.call(s,i)&&w(n,i,s[i]);return n},h=(n,s)=>z(n,S(s));var y=(n,s,i)=>new Promise((r,l)=>{var o=c=>{try{x(i.next(c))}catch(m){l(m)}},b=c=>{try{x(i.throw(c))}catch(m){l(m)}},x=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,b);x((i=i.apply(n,s)).next())});import{r as g,j as e,P as I,k as E,l as Y,E as P}from"./vendor-DFO5Jmbo.js";import{c as D,b as j}from"./api-vXz7ElHN.js";import{M}from"./Modal-D9XuV0-K.js";import{I as A}from"./ImageUpload-CSofYKUZ.js";function K({isOpen:n,onClose:s,onSubmit:i,post:r}){const[l,o]=g.useState({title:(r==null?void 0:r.title)||"",content:(r==null?void 0:r.content)||"",excerpt:(r==null?void 0:r.excerpt)||"",coverImage:(r==null?void 0:r.coverImage)||"",tags:(r==null?void 0:r.tags)||[],published:(r==null?void 0:r.published)||!1,categoryId:(r==null?void 0:r.categoryId)||""}),[b,x]=g.useState(!1),[c,m]=g.useState(""),[f,v]=g.useState([]);g.useEffect(()=>{y(this,null,function*(){try{const d=yield D.getAll();v(d)}catch(d){console.error("Kategoriler yüklenirken hata:",d)}})},[]);const a=t=>y(this,null,function*(){t.preventDefault(),x(!0),m("");try{yield i(l),s()}catch(d){m("Bir hata oluştu"),console.error(d)}finally{x(!1)}});return e.jsx(M,{isOpen:n,onClose:s,title:r?"Blog Yazısını Düzenle":"Yeni Blog Yazısı",children:e.jsxs("form",{onSubmit:a,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Başlık"}),e.jsx("input",{type:"text",value:l.title,onChange:t=>o(h(u({},l),{title:t.target.value})),className:"w-full px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Blog yazısı başlığı",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"İçerik"}),e.jsx("textarea",{value:l.content,onChange:t=>o(h(u({},l),{content:t.target.value})),className:"w-full px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Blog yazısı içeriği",rows:8,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Özet"}),e.jsx("textarea",{value:l.excerpt,onChange:t=>o(h(u({},l),{excerpt:t.target.value})),className:"w-full px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Blog yazısı özeti",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kategori"}),e.jsxs("select",{value:l.categoryId,onChange:t=>o(h(u({},l),{categoryId:t.target.value})),className:"w-full px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Kategori Seçin"}),f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kapak Görseli"}),e.jsx(A,{currentImage:l.coverImage,onUpload:t=>o(h(u({},l),{coverImage:t}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Etiketler (virgülle ayırın)"}),e.jsx("input",{type:"text",value:l.tags.join(", "),onChange:t=>{const d=t.target.value.split(",").map(p=>p.trim()).filter(p=>p!=="");o(h(u({},l),{tags:d}))},className:"w-full px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"React, TypeScript, Web"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"published",checked:l.published,onChange:t=>o(h(u({},l),{published:t.target.checked})),className:"w-4 h-4 text-blue-500 border-gray-700 rounded focus:ring-blue-500 focus:ring-offset-gray-900"}),e.jsx("label",{htmlFor:"published",className:"ml-2 text-sm font-medium text-gray-300",children:"Yayınla"})]}),c&&e.jsx("div",{className:"text-red-400 bg-red-500/10 p-3 rounded-lg text-sm",children:c}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-400 hover:text-gray-300 transition-colors",disabled:b,children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",disabled:b,children:b?"Kaydediliyor...":r?"Güncelle":"Ekle"})]})]})})}function q(){const[n,s]=g.useState([]),[i,r]=g.useState(!0),[l,o]=g.useState(""),[b,x]=g.useState(!1),[c,m]=g.useState(void 0),f=()=>y(this,null,function*(){try{r(!0);const a=yield j.getAll();s(a),o("")}catch(a){o("Blog yazıları yüklenirken bir hata oluştu"),console.error(a)}finally{r(!1)}});g.useEffect(()=>{f()},[]);const v=a=>y(this,null,function*(){if(window.confirm("Bu blog yazısını silmek istediğinizden emin misiniz?"))try{yield j.delete(a),yield f()}catch(t){o("Blog yazısı silinirken bir hata oluştu"),console.error(t)}});return i?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Blog Yazıları"}),e.jsxs("button",{onClick:()=>{m(void 0),x(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(I,{size:20}),"Yeni Yazı"]})]}),l&&e.jsx("div",{className:"bg-red-500/10 text-red-400 p-4 rounded-lg",children:l}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(a=>{var t;return e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50 rounded-lg overflow-hidden hover:border-gray-600/50 transition-colors",children:[e.jsx("img",{src:a.coverImage,alt:a.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:a.title}),e.jsx("span",{className:`px-2 py-1 text-sm rounded ${a.published?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:a.published?"Yayında":"Taslak"})]}),e.jsx("p",{className:"text-gray-400 line-clamp-3",children:a.excerpt}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(t=a.tags)==null?void 0:t.map(d=>e.jsx("span",{className:"px-2 py-1 bg-gray-700/50 text-gray-300 text-sm rounded",children:d},d))}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{m(a),x(!0)},className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Düzenle",children:e.jsx(E,{size:20})}),e.jsx("button",{onClick:()=>v(a.id),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Sil",children:e.jsx(Y,{size:20})})]}),e.jsx("a",{href:`/blog/${a.slug}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Yazıyı Görüntüle",children:e.jsx(P,{size:20})})]})]})]},a.id)})}),e.jsx(K,{isOpen:b,onClose:()=>{x(!1),m(void 0)},onSubmit:a=>y(this,null,function*(){if(c){const t=u(u({},c),a);yield j.update(c.id,t)}else{const t=a.title.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,""),d=Math.ceil(a.content.split(/\s+/).length/200),p=h(u({},a),{slug:t,readTime:d,tags:a.tags||[]});yield j.create(p)}yield f()}),post:c})]})}export{q as AdminBlog};
