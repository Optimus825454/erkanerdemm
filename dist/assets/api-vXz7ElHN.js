var $=Object.defineProperty,b=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var p=(t,e,r)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,g=(t,e)=>{for(var r in e||(e={}))m.call(e,r)&&p(t,r,e[r]);if(h)for(var r of h(e))w.call(e,r)&&p(t,r,e[r]);return t},y=(t,e)=>b(t,T(e));var k=(t,e)=>{var r={};for(var a in t)m.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&h)for(var a of h(t))e.indexOf(a)<0&&w.call(t,a)&&(r[a]=t[a]);return r};var f=(t,e,r)=>p(t,typeof e!="symbol"?e+"":e,r);var s=(t,e,r)=>new Promise((a,i)=>{var c=n=>{try{l(r.next(n))}catch(u){i(u)}},d=n=>{try{l(r.throw(n))}catch(u){i(u)}},l=n=>n.done?a(n.value):Promise.resolve(n.value).then(c,d);l((r=r.apply(t,e)).next())});const A={apiUrl:"http://localhost:5005/api"};class E{constructor(e){f(this,"baseUrl");f(this,"refreshPromise",null);this.baseUrl=e}getHeaders(e=!1){return s(this,null,function*(){const r=new Headers({"Content-Type":"application/json"});if(e){const a=localStorage.getItem("adminToken");a&&r.append("Authorization",`Bearer ${a}`)}return r})}refreshToken(){return s(this,null,function*(){return this.refreshPromise?this.refreshPromise:(this.refreshPromise=new Promise((e,r)=>s(this,null,function*(){try{const a=localStorage.getItem("refreshToken");if(!a)throw new Error("No refresh token available");const i=yield fetch(`${this.baseUrl}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:a})});if(!i.ok)throw new Error("Failed to refresh token");const c=yield i.json();localStorage.setItem("adminToken",c.token),localStorage.setItem("tokenExpiry",(Date.now()+36e5).toString()),e(c.token)}catch(a){localStorage.removeItem("adminToken"),localStorage.removeItem("adminAuthenticated"),localStorage.removeItem("tokenExpiry"),localStorage.removeItem("refreshToken"),r(a)}finally{this.refreshPromise=null}})),this.refreshPromise)})}handleResponse(e){return s(this,null,function*(){if(!e.ok){if(e.status===401)try{return yield this.refreshToken(),null}catch(r){throw new Error("Authentication failed")}try{const r=yield e.json();throw new Error(r.message||"API error occurred")}catch(r){throw new Error("API error occurred")}}try{const r=yield e.json();if(!r)throw new Error("Empty response received");return r}catch(r){if(e.status===204)return null;throw new Error("Invalid JSON response")}})}request(a){return s(this,arguments,function*(e,r={}){const u=r,{requiresAuth:i=!1}=u,c=k(u,["requiresAuth"]),d=yield this.getHeaders(i),l=yield fetch(`${this.baseUrl}${e}`,y(g({},c),{headers:d})),n=yield this.handleResponse(l);if(n===null&&l.status===401){const S=yield fetch(`${this.baseUrl}${e}`,y(g({},c),{headers:yield this.getHeaders(i)}));return this.handleResponse(S)}return n})}get(e,r=!1){return s(this,null,function*(){return this.request(e,{method:"GET",requiresAuth:r})})}post(e,r,a=!1){return s(this,null,function*(){return this.request(e,{method:"POST",body:JSON.stringify(r),requiresAuth:a})})}put(e,r,a=!1){return s(this,null,function*(){return this.request(e,{method:"PUT",body:JSON.stringify(r),requiresAuth:a})})}delete(e,r=!1){return s(this,null,function*(){return this.request(e,{method:"DELETE",requiresAuth:r})})}}const o=new E(A.apiUrl),v={getAll:()=>s(void 0,null,function*(){return o.get("/projects")}),create:t=>s(void 0,null,function*(){return o.post("/projects",t,!0)}),update:(t,e)=>s(void 0,null,function*(){return o.put(`/projects/${t}`,e,!0)}),delete:t=>s(void 0,null,function*(){return o.delete(`/projects/${t}`,!0)})},P={getAll:()=>s(void 0,null,function*(){return o.get("/blog")}),create:t=>s(void 0,null,function*(){return o.post("/blog",t,!0)}),update:(t,e)=>s(void 0,null,function*(){return o.put(`/blog/${t}`,e,!0)}),delete:t=>s(void 0,null,function*(){return o.delete(`/blog/${t}`,!0)})},j={getAll:()=>s(void 0,null,function*(){return o.get("/videos")}),create:t=>s(void 0,null,function*(){return o.post("/videos",t,!0)}),update:(t,e)=>s(void 0,null,function*(){return o.put(`/videos/${t}`,e,!0)}),delete:t=>s(void 0,null,function*(){return o.delete(`/videos/${t}`,!0)})},U={login:t=>s(void 0,null,function*(){return o.post("/auth/login",t)})},O={getAll:()=>s(void 0,null,function*(){return o.get("/categories")}),getBySlug:t=>s(void 0,null,function*(){return o.get(`/categories/${t}`)}),create:t=>s(void 0,null,function*(){return o.post("/categories",t,!0)}),update:(t,e)=>s(void 0,null,function*(){return o.put(`/categories/${t}`,e,!0)}),delete:t=>s(void 0,null,function*(){return o.delete(`/categories/${t}`,!0)})},q={uploadImage:t=>s(void 0,null,function*(){const e=new FormData;e.append("image",t);const r=yield fetch(`${A.apiUrl}/uploads`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:e});if(!r.ok)throw new Error("Resim yüklenirken bir hata oluştu");return r.json()}),deleteImage:t=>s(void 0,null,function*(){return o.delete(`/uploads/${t}`,!0)})};export{U as a,P as b,O as c,v as p,q as u,j as v};
